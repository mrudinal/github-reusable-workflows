# Calls the reusable workflow in the "github-reusable-workflows" repo to configure
# Cloudflare Zero Trust Access with a One-time PIN gate in front of a hostname (and
# optional path), and an allow policy based on email addresses.
#
# Required GitHub Secrets in *this* repository:
# - CF_API_TOKEN
# - CF_ACCOUNT_ID
#
# Required GitHub Variables in *this* repository:
# - CF_ACCESS_APP_NAME
# - CF_ACCESS_DOMAIN
# - CF_ACCESS_SUBDOMAIN
# - CF_ACCESS_SESSION_DURATION
# - CF_ACCESS_POLICY_NAME
# - CF_ALLOWED_EMAILS
#
# Optional GitHub Variables in *this* repository:
# - CF_ACCESS_PATH
#
# Note: Update the `uses:` line to point at your workflow repo + ref.

name: "Cloudflare Zero Trust Access: One-time PIN gate (caller)"

on:
  workflow_dispatch:

jobs:
  call-reusable:
    name: "Configure Cloudflare Zero Trust Access"
    uses: Max/github-reusable-workflows/.github/workflows/cloudflare-zerotrust-access-otp.yml@main
    secrets:
      CF_API_TOKEN: ${{ secrets.CF_API_TOKEN }}
      CF_ACCOUNT_ID: ${{ secrets.CF_ACCOUNT_ID }}
